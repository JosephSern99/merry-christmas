<!-- This is skeleton HTML required for the Popup page. -->
<div class="listing-popup-page-container edit-page-container">
    <div class="row breadcrumb-container mb-4" *ngIf="detail">
        <div class="col-8">
            <app-listing-popup-breadcrumb [replace]="{customerName: detail.fullname}"></app-listing-popup-breadcrumb>
        </div>
    </div>

    <div class="title-agmo-form">
        <h5 class="page-title">Client Basic Info</h5>
    </div>

    <div class="title-divider"></div>

    <form *ngIf="editForm" class="agmo-form" [formGroup]="editForm" [class.show-error]="showFormError">

        <div class="row">
            <div class="col-12">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Full Name</mat-label>
                    <input matInput formControlName="fullname" required>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>NRIC/Passport No.</mat-label>
                    <input matInput formControlName="identityNo" readonly>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Email</mat-label>
                    <input matInput type="email" formControlName="email" readonly>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Phone Number</mat-label>
                    <div class="d-flex" style="align-items: center;">
                        <mat-select class="country-code-select" formControlName="countryCode" required>
                            <mat-option value="0">+60</mat-option>
                            <mat-option value="1">+65</mat-option>
                        </mat-select>
                        <input matInput type="tel" formControlName="phoneNumber" required>
                    </div>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Date of Birth</mat-label>
                    <input matInput [matDatepicker]="picker" formControlName="birthday" required>
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Employment Status</mat-label>
                    <mat-select formControlName="employmentStatusId">
                        <mat-option *ngFor="let employmentStatus of employmentStatusList" [value]="+employmentStatus.id">
                            {{employmentStatus.infoText}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline"
                    matTooltip="Current employment status does not require nature of business"
                    [matTooltipDisabled]="isBusinessNatureEnabled" matTooltipPosition="after"
                    matTooltipClass="nature-of-business-tooltip">
                    <mat-label>Nature of Business</mat-label>
                    <mat-select formControlName="businessNatureId">
                        <mat-option *ngFor="let businessNature of businessNatureList" [value]="businessNature.id">
                            {{businessNature.infoText}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Nationality</mat-label>
                    <mat-select formControlName="nationalityId">
                        <mat-option *ngFor="let nationality of nationalities" [value]="+nationality.id">
                            {{nationality.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Jurisdiction of tax residence:</mat-label>
                    <div class="d-flex">
                        <mat-select class="country-code-select" formControlName="jurisdictionCode" (selectionChange)="onRemoveTinDetail(null);">
                            <mat-option [value]="0">Yes</mat-option>
                            <mat-option [value]="1">No</mat-option>
                        </mat-select>
                        <button type="button" class="btn btn-outline-secondary rounded w-100 ml-2 my-1 font-weight-bold"
                            [class.disabled]="editForm.get('jurisdictionCode').value !== 0" (click)="onAddTinDetail()">Add
                            tax residency</button>
                    </div>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-2 px-3 row tin-row" formArrayName="tinDetail"
            *ngIf="editForm.get('jurisdictionCode').value === 0">
            <div class="col-5 bg-light rounded border position-relative" [formGroupName]="i"
                *ngFor="let tinDetailControl of tinDetailControls; let i = index">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-7 py-2 pl-0">
                            <mat-form-field class="w-100" appearance="outline">
                                <mat-label>Country</mat-label>
                                <mat-select formControlName="countryId">
                                    <mat-option *ngFor="let country of countries" [value]="country.id">
                                        {{country.name}}
                                    </mat-option>
                                </mat-select>
                                <mat-error class="mt-3 font-weight-bold">Country is required</mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-5 py-2 px-0">
                            <mat-form-field class="w-100" appearance="outline">
                                <mat-label>TIN number</mat-label>
                                <input matInput type="number" formControlName="tin">
                                <mat-error class="mt-3 font-weight-bold">TIN number is required</mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
                <button *ngIf="tinDetailControls.length > 1" mat-mini-fab color="warn"
                    class="position-absolute close-icon" (click)="onRemoveTinDetail(i)">
                    <mat-icon>close</mat-icon>
                </button>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Gender:</mat-label>
                    <mat-select formControlName="gender">
                        <mat-option *ngFor="let gender of GenderOptions | keyvalue" [value]="+gender.key">
                            {{gender.value}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Race:</mat-label>
                    <mat-select formControlName="race">
                        <mat-option *ngFor="let race of RaceOptions | keyvalue" [value]="+race.key">
                            {{race.value}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-md-4">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Annual Income:</mat-label>
                    <mat-select formControlName="incomeId">
                        <mat-option *ngFor="let incomeId of incomeList" [value]="+incomeId.id">
                            {{incomeId.infoText}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12">
                <mat-form-field class="w-100" appearance="outline"
                    matTooltip="Type hobby and save with comma or enter">
                    <mat-label>Hobbies/Interest:</mat-label>
<!--                    <mat-chip-list #chipList>-->
<!--                        <mat-chip color="primary" *ngFor="let hobby of hobbyList" (removed)="removeHobby(hobby)">-->
<!--                            {{ hobby }}-->
<!--                            <i matChipRemove class="fa fa-times"></i>-->
<!--                        </mat-chip>-->
<!--                        <input [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"-->
<!--                            (matChipInputTokenEnd)="addHobby($event)">-->
<!--                    </mat-chip-list>-->
                </mat-form-field>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12 text-right">
                <button class="mat-button primary darkblue btn primary-submit-button border-0" (click)="onSubmit()">
                    Submit
                </button>
            </div>
        </div>
    </form>
</div>
