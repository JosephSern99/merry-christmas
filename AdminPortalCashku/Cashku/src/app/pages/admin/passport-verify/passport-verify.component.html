<!-- This is skeleton HTML required for the Listing page. -->
<div class="listing-page">
    <div class="d-flex align-items-center justify-content-between mb-4">
        <div class="title-container mb-4">
            <div class="page-title">PASSPORT VERIFICATION</div>
        </div>
        <div [formGroup]="filterFormGroup">
            <mat-form-field class="agmo-dropdown-container" >
                <mat-label class="agmo-dropdown-mini-label">Verification Status</mat-label>
                <mat-select class="agmo-dropdown-content" formControlName="verificationStatus">
                    <mat-option *ngFor="let verification of PASSPORT_VERIFICATION_STATUS | enumToArray" [value]="verification.value">
                        {{verification.label}}</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>

    <div class="contain-container">
        <mat-table matSort class="agmo-table" [dataSource]="listingDataSource"
            (matSortChange)="onSortChange($event)">
            <ng-container matColumnDef="index">
                <th mat-header-cell *matHeaderCellDef>No.</th>
                <td mat-cell *matCellDef="let verification">{{verification.index}}</td>
            </ng-container>

            <ng-container matColumnDef="fullname">
                <th mat-header-cell  *matHeaderCellDef>Client Name</th>
                <td mat-cell class="clickable" *matCellDef="let verification"
                    (click)="detailPopup(verification.utilityBillImageUrl, verification.submissionDate)">{{verification.fullname}}
                </td>
            </ng-container>

            <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef >Email</th>
                <td mat-cell *matCellDef="let verification">{{verification.email}}</td>
            </ng-container>

            <ng-container matColumnDef="submittedDocumentName">
                <th mat-header-cell *matHeaderCellDef >Submitted Documents</th>
                <td mat-cell *matCellDef="let verification">{{verification.submittedDocumentName}}</td>
            </ng-container>

            <ng-container matColumnDef="submissionDate">
                <th mat-header-cell  *matHeaderCellDef>Submission Date</th>
                <td mat-cell *matCellDef="let verification">{{verification.submissionDate | date:'DD-MM-YYYY HH:mm' }}
                </td>
            </ng-container>

            <ng-container matColumnDef="passportVerificationStatus">
                <th mat-header-cell  *matHeaderCellDef>Verification Status</th>
                <td mat-cell *matCellDef="let verification">
                    <span class="agmo-status text-nowrap"
                        [ngClass]="verification.passportVerificationStatus == PassportVerificationStatus.Rejected ? 'red' : verification.passportVerificationStatus == PassportVerificationStatus.Approved ? 'green' : 'orange'">
                        {{PassportVerificationStatus[verification.passportVerificationStatus]}}
                    </span>
                </td>
            </ng-container>

            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef>Action</th>
                <td mat-cell *matCellDef="let verification">
                    <div class="text-nowrap" *ngIf="verification.passportVerificationStatus == PassportVerificationStatus.Pending">
                        <img src="/assets/images/approve_circle_green@2x.png" class="action-icon mr-3"
                            (click)="onApprovalClick(verification.userId, ApprovalAction.Approve)" alt="">
                        <img src="/assets/images/reject_circle_red@2x.png" class="action-icon"
                            (click)="onApprovalClick(verification.userId, ApprovalAction.Reject)" alt="">
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef=" displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <ng-container matColumnDef="loading">
                <td mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns.length">
                    <mat-progress-bar mode="query"></mat-progress-bar>
                </td>
            </ng-container>
            <ng-container matColumnDef="noData">
                <td mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns.length" class="no-data">No
                    data</td>
            </ng-container>

            <tr class="no-data" mat-footer-row *matFooterRowDef="['loading']" [class.show]="isListingLoading"></tr>
            <tr class="no-data" mat-footer-row *matFooterRowDef="['noData']" [class.show]="isListEmpty()"></tr>
        </mat-table>

        <mat-paginator [length]="pagination.length" [pageSize]="pagination.pageSize" [pageIndex]="pagination.pageIndex"
            [pageSizeOptions]="pagination.pageSizeOptions" (page)="onPaginationChange($event)"></mat-paginator>

    </div>

    <!-- This is required for the Popup page to overlay the Listing page. -->
    <div class="listing-popup-page" [class.show]="isDetailPopupShow">

        <!-- This spinner or loading button is to indicate popup page is loading. -->
        <div class="center">
            <mat-spinner></mat-spinner>
        </div>

        <!-- Popup page contain is render within here. -->
        <router-outlet (activate)="onOutletActivate()" (deactivate)="onOutletDeactivate($event)"></router-outlet>
    </div>
</div>
