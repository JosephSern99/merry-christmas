<!-- This is skeleton HTML required for the Listing page. -->
<div class="listing-page">

    <div class="row title-container mb-4">
        <div class="col-8 page-title">FEES MANAGEMENT</div>
    </div>
    <form class="box-container my-5 agmo-form" [formGroup]="editForm" [class.show-error]="showFormError" (ngSubmit)="onSubmit()">
        <div class="row">
            <div class="col-6">
                <div class="mb-4">
                    <div class="mb-2">Funds:</div>
                    <div class="d-flex align-items-center">
                        <div class="flex-grow-1">
                            <mat-form-field class="w-100" appearance="outline">
                                <mat-select placeholder="- Select Fund -"
                                    formControlName="fundOption"
                                    (selectionChange)="updateSelection($event)">
                                    <mat-option *ngFor="let option of fundOptions" [value]="option.scheme">
                                        {{option.fundName}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="mb-2">Wrap Fee :</div>
                    <div class="d-flex align-items-center">
                        <div class="flex-grow-1 d-flex">
                            <input type="number" class="form-control agmo-input" formControlName="wrapFee"><span class="percentage-return">%</span>
                        </div>


                    </div>
                </div>
            </div>
            <div class="col-6">
                <h6 class="remark-font">Remark:</h6>
                <p>All other funds follow existing wrap fees computation:</p>
                <p class="font-weight-bold">1.5%, 2.0%, 2.5%</p>
            </div>
        </div>

        <div class="mt-3 row">
            <div class="col-12 text-right">
                <button [class.disable]="editForm.invalid" class="mat-button btn primary darkblue font-weight-bold border-0" type="submit">
                    Submit
                </button>
            </div>
        </div>
    </form>

    <div class="d-flex align-items-center mb-3">
        <h5 class="font-weight-bold">Money Market Fund Wrap Fees Computation</h5>
    </div>

    <div class="contain-container">
        <mat-table matSort class="agmo-table" [dataSource]="listingDataSource"
            (matSortChange)="onSortChange($event)">
            <ng-container matColumnDef="index">
                <th mat-header-cell *matHeaderCellDef>No.</th>
                <td mat-cell *matCellDef="let fees">{{fees.index}}</td>
            </ng-container>

            <ng-container matColumnDef="fundName">
                <th mat-header-cell  *matHeaderCellDef>Title</th>
                <td mat-cell class="clickable" *matCellDef="let fees">{{fees.fundName
                    || '-'}}</td>
            </ng-container>

            <ng-container matColumnDef="wrapFee">
                <th mat-header-cell  *matHeaderCellDef>Wrap Fee</th>
                <td mat-cell *matCellDef="let fees">{{fees.wrapFee}}</td>
            </ng-container>

            <ng-container matColumnDef="modifiedAt">
                <th mat-header-cell  *matHeaderCellDef>Updated On</th>
                <td mat-cell *matCellDef="let fees">
                    <div>{{ fees.modifiedAt | date:'D MMM YYYY, HH:mm' }}</div>
                </td>
            </ng-container>

            <ng-container matColumnDef="threeDotMenu">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let fees" class="text-right">
                    <button mat-icon-button [matMenuTriggerFor]="menu">
                        <mat-icon class="three-dot-menu"></mat-icon>
                    </button>
                    <mat-menu #menu="matMenu" xPosition="before">
                        <button mat-menu-item (click)="removeFee(fees.scheme)">
                            <span class="red-text">Remove</span>
                        </button>
                    </mat-menu>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <ng-container matColumnDef="loading">
                <td mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns.length">
                    <mat-progress-bar mode="query"></mat-progress-bar>
                </td>
            </ng-container>
            <ng-container matColumnDef="noData">
                <td mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns.length" class="no-data">No data
                </td>
            </ng-container>

            <tr class="no-data" mat-footer-row *matFooterRowDef="['loading']" [class.show]="isListingLoading"></tr>
            <tr class="no-data" mat-footer-row *matFooterRowDef="['noData']" [class.show]="isListEmpty()"></tr>
        </mat-table>

        <mat-paginator [length]="pagination.length" [pageSize]="pagination.pageSize" [pageIndex]="pagination.pageIndex"
            [pageSizeOptions]="pagination.pageSizeOptions" (page)="onPaginationChange($event)"></mat-paginator>
    </div>

    <!-- This is required for the Popup page to overlay the Listing page. -->
    <div class="listing-popup-page" [class.show]="isDetailPopupShow">
        <!-- This spinner or loading button is to indicate popup page is loading. -->
        <div class="center">
            <mat-spinner></mat-spinner>
        </div>

        <!-- Popup page contain is render within here. -->
        <router-outlet (activate)="onOutletActivate()" (deactivate)="onOutletDeactivate($event)"></router-outlet>
    </div>
</div>
